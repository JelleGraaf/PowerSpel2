function Invoke-AdminPC {
    <#
    .SYNOPSIS
        Starts the interactable Admin PC.
        
    .DESCRIPTION
        Starts the interactable Admin PC. It allows the player to interact with a pc, with a logged on administrative account.
    #>

    # Import machine data from file.
    $InteractableData = Get-Content "$PSScriptRoot\AdminPC.json" | ConvertFrom-Json -AsHashtable
    
    $Script:MachineState = "Running"
    $AttemptCounter = 0
    while ($Script:MachineState -eq "Running") {

        # Write header to screen.
        Show-Header

        # Write map to screen, if enabled.
        if ($MapStyle) {
            Show-Map -MapStyle $MapStyle
        }
    
        # Write previous action to screen, if any.
        if ($ActionMessage) {
            Write-WordWrapHost $ActionMessage -Color Green
            if (!$CompletedAchievement) { Write-Host } # Skip this empty line when an achievement is completed, it looks better that way.
        }
        # Write room title to screen.
        Write-Host "[$($World."$($State.CurrentRoom)".RoomTitle)]" -BackgroundColor White -ForegroundColor Black
        Write-Host
    
        # Write room description to screen.
        Write-WordWrapHost "$($World."$($State.CurrentRoom)".RoomDescription)"

        # Write exits to screen.
        Show-Exits

        # Take inventory of all the options at the admin pc.
        $AdminPCOptions = @{}
        $i = 1
        foreach ($Option in $InteractableData.Keys) {
            $AdminPCOptions.$i = $InteractableData.$Option
            $i++
        }

        # Write interactable specific actions to screen.
        Write-WordWrapHost "So... what now?" -Color Magenta
        Write-Host

        foreach ($Number in $AdminPCOptions.Keys | Sort-Object) {
            Write-Host "$Number`: $($AdminPCOptions.$Number.MenuDescription)"
        }
        Write-Host

        # Read player action.
        $PlayerInput = $null
        while (('1', '2', '3', '4', '5', '6', '7', '8', '9') -notcontains $PlayerInput) {
            $PlayerInput = Read-Host "What would you like to do?"
        }
        [int]$PlayerInput = $PlayerInput

        # Process player action.
        if ((@(1..9) -contains $PlayerInput -and $PlayerInput -le $AdminPCOptions.Count)) {
            if ($AdminPCOptions.$PlayerInput.MenuDescription -eq "Send a prank e-mail.") {
                $Script:ActionMessage = $AdminPCOptions.$PlayerInput.ActionMessage
                $AttemptCounter++
                $interactableData.Remove("SendEmail")
                $Script:MachineState = "Running"
            }
            elseif ($AdminPCOptions.$PlayerInput.MenuDescription -eq "Search for passwords.") {
                $Script:ActionMessage = $AdminPCOptions.$PlayerInput.ActionMessage
                Invoke-CompleteExploit -ExploitName "Retrieved administrative passwords"
                $AttemptCounter++
                $interactableData.Remove("SearchPasswords")
                $Script:MachineState = "Running"
            }
            elseif ($AdminPCOptions.$PlayerInput.MenuDescription -eq "Create a backdoor account for later use.") {
                $Script:ActionMessage = $AdminPCOptions.$PlayerInput.ActionMessage
                $AttemptCounter++
                $interactableData.Remove("CreateBackdoor")
                $Script:MachineState = "Running"
            }
            elseif ($AdminPCOptions.$PlayerInput.MenuDescription -eq "Walk away from the PC.") {
                $Script:ActionMessage = $AdminPCOptions.$PlayerInput.ActionMessage
                $Script:MachineState = "Completed"
            }
        }
        else {
            $Script:ActionMessage = "Invalid choice. Try again"
            $Script:MachineState = "Running"
        }

        # End the game if the player spends too much time at the PC.
        if ($AttemptCounter -ge 3) {
            Write-wordwrapHost "Someone looks up at you, realizes what you are doing and calls you out! This is probably the end of your assignment..." -Color Green
            Start-Sleep -Seconds 3
            $Script:MachineState = "Completed"
            $Script:EndScenario = "Caught"
            $Script:GameState = "Quit"
        }
    }
}