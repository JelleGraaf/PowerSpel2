function Invoke-PlayPirateNumberGuessing {
    Clear-Host
    [int]$guess = 0
    [int]$attempt = 0
    [int]$number = Get-Random -Minimum 1 -Maximum 100
    Write-Host ""
    Write-Host "                     _____"
    Write-Host "                    /     \"
    Write-Host "                   | () () |"
    Write-Host "                    \  ^  /"
    Write-Host "                     |||||"
    Write-Host "                     |||||"
    Write-Host ""
    Write-Host "Ahoy matey! I'm the Dreaded Pirate Robbins, and I have a secret!"
    Write-Host "It's a number between 1 and 100. I'll give you 7 tries to guess it."
    Write-Host ""
    do {
        try {
            $guess = Read-Host "What's your guess?"
            if ($guess -lt 1 -or $guess -gt 100) {
                throw
            }
        }
        catch {
            Write-Host "Invalid number" 
            continue
        }
        if ($guess -lt $number) {
            Write-Host "   Too low, yee scurry dog!" -ForegroundColor Red
        }
        elseif ($guess -gt $number) {
            Write-Host "   Too high, yee land lubber!" -ForegroundColor Red
        }
        $attempt += 1
    }
    until ($guess -eq $number -or $attempt -eq 7)
    if ($guess -eq $number) {
        Write-Host ""
        Write-Host "Avast! Yee guessed my secret number, yee did!" -ForegroundColor Green
        Write-Host ""

    }
    else {
        Write-Host ""
        Write-Host "Yee out of guesses! Better luck next time, yee matey!"
        Write-Host "My secret number was " -NoNewline
        Write-Host $number -ForegroundColor Yellow
        Write-Host ""
    }
    Pause

    # Add achievement
    Invoke-CompleteAchievement -AchievementName "Gamer at heart"
}
